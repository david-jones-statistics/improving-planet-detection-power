geometric_cov code needs to be double-checked